SELECT CAST(COUNT(DISTINCT e.uuid) AS INT) AS count, DATE_TRUNC('day', e.occurred_at) AS group_by_date FROM (SELECT uuid AS uuid, argMax(e.name, e.occurred_at) AS name, argMax(e.properties, e.occurred_at) AS properties, argMax(e.user_profile_id, e.occurred_at) AS user_profile_id, MAX(occurred_at) AS occurred_at FROM events AS e WHERE e.swishjam_api_key IN ('my_public_key') AND e.occurred_at BETWEEN '2020-12-30 00:00:00' AND '2021-01-01 23:59:59' AND e.name = 'event_1' GROUP BY uuid ) AS e LEFT JOIN ( SELECT swishjam_user_id, argMax(merged_into_swishjam_user_id, updated_at) AS merged_into_swishjam_user_id FROM swishjam_user_profiles WHERE workspace_id = 'xyz' GROUP BY swishjam_user_id ) AS user_profiles ON user_profiles.swishjam_user_id = e.user_profile_id WHERE notEmpty(e.uuid) AND ( user_profiles.swishjam_user_id = '1' OR user_profiles.merged_into_swishjam_user_id = '1' ) AND 1 = 1 GROUP BY group_by_date ORDER BY group_by_date